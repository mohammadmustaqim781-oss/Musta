<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Noor AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Amiri&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #020617; 
            color: #f8fafc; 
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden; /* Prevents the whole page from bouncing, we scroll the inner div instead */
        }
        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(16, 185, 129, 0.2); }
        .arabic { font-family: 'Amiri', serif; font-size: 1.6rem; line-height: 2.2; color: #10b981; }
        
        /* SCROLL FIX: This ensures the content is scrollable on mobile */
        .content-area { 
            flex: 1; 
            overflow-y: auto; 
            -webkit-overflow-scrolling: touch; 
            padding-bottom: 120px; /* Space for the floating input and nav */
        }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .tasbih-btn:active { transform: scale(0.90); transition: transform 0.1s; }
        .loading-dot { animation: bounce 1.4s infinite ease-in-out; }
        @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
        
        /* Custom scrollbar for better look */
        ::-webkit-scrollbar { width: 3px; }
        ::-webkit-scrollbar-thumb { background: #10b981; border-radius: 10px; }
    </style>
</head>
<body class="flex items-center">

    <div class="w-full max-w-md h-screen flex flex-col bg-slate-950 shadow-2xl relative mx-auto border-x border-emerald-900/20">
        
        <!-- Fixed Header -->
        <header class="shrink-0 p-5 flex items-center justify-between z-20 border-b border-emerald-900/20 bg-slate-950/80 backdrop-blur-md">
            <div>
                <h1 class="text-2xl font-black bg-gradient-to-r from-emerald-400 to-teal-300 bg-clip-text text-transparent">NOOR AI</h1>
                <p class="text-[9px] tracking-[0.2em] text-emerald-500 font-bold uppercase">Divine Wisdom</p>
            </div>
            <div class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse shadow-[0_0_8px_rgba(16,185,129,1)]"></div>
        </header>

        <!-- Main Scrollable Content Area -->
        <div class="content-area" id="scroll-container">
            
            <!-- Home Tab -->
            <div id="home" class="tab-content active p-5 space-y-6">
                <div class="glass p-6 rounded-3xl relative overflow-hidden">
                    <h3 class="text-emerald-400 text-xs font-bold flex items-center mb-4 uppercase tracking-wider">
                        Verse of the Day
                    </h3>
                    <p class="arabic text-right mb-4">ŸÅŸéÿßÿ∞ŸíŸÉŸèÿ±ŸèŸàŸÜŸêŸä ÿ£Ÿéÿ∞ŸíŸÉŸèÿ±ŸíŸÉŸèŸÖŸí</p>
                    <p class="italic text-slate-300 text-sm">"So remember Me; I will remember you."</p>
                    <p class="text-[10px] text-emerald-600 mt-2 font-bold">‚Äî Surah Al-Baqarah 2:152</p>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div onclick="switchTab('chat')" class="glass p-5 rounded-3xl flex flex-col items-center cursor-pointer active:bg-emerald-900/30">
                        <span class="text-3xl mb-2">üí¨</span>
                        <span class="text-xs font-bold text-slate-200">Chat AI</span>
                    </div>
                    <div onclick="switchTab('tasbih')" class="glass p-5 rounded-3xl flex flex-col items-center cursor-pointer active:bg-emerald-900/30">
                        <span class="text-3xl mb-2">üìø</span>
                        <span class="text-xs font-bold text-slate-200">Tasbih</span>
                    </div>
                </div>

                <div class="space-y-3">
                    <h4 class="text-[10px] font-bold text-slate-500 uppercase tracking-[0.2em] px-1">Quick Access</h4>
                    <div onclick="askAI('Give me a morning dua')" class="glass p-4 rounded-2xl flex justify-between items-center cursor-pointer active:scale-95 transition-all">
                        <span class="text-sm font-medium">Morning Adhkar</span>
                        <span class="text-emerald-500">‚Üí</span>
                    </div>
                    <div onclick="askAI('What are the benefits of Ayatul Kursi?')" class="glass p-4 rounded-2xl flex justify-between items-center cursor-pointer active:scale-95 transition-all">
                        <span class="text-sm font-medium">Ayatul Kursi Benefits</span>
                        <span class="text-emerald-500">‚Üí</span>
                    </div>
                    <div onclick="askAI('Tell me a story of a Prophet')" class="glass p-4 rounded-2xl flex justify-between items-center cursor-pointer active:scale-95 transition-all">
                        <span class="text-sm font-medium">Prophetic Stories</span>
                        <span class="text-emerald-500">‚Üí</span>
                    </div>
                </div>
            </div>

            <!-- Chat Tab -->
            <div id="chat" class="tab-content p-5">
                <div id="chat-messages" class="space-y-4">
                    <div class="flex justify-start">
                        <div class="glass p-4 rounded-2xl rounded-bl-none max-w-[85%] text-sm leading-relaxed">
                            Assalamu Alaikum! I am Noor, your AI assistant. Ask me anything about Islam.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tasbih Tab -->
            <div id="tasbih" class="tab-content p-6 flex flex-col items-center space-y-10">
                <div class="text-center pt-10">
                    <h2 class="text-2xl font-black text-white uppercase tracking-tighter">Digital Tasbih</h2>
                    <p id="tasbih-phrase" class="text-emerald-500 text-xs tracking-widest font-bold mt-1">SUBHANALLAH</p>
                </div>
                
                <button onclick="countTasbih()" class="tasbih-btn w-64 h-64 rounded-full glass border-[12px] border-emerald-500/10 flex flex-col items-center justify-center relative shadow-2xl">
                    <span id="tasbih-display" class="text-7xl font-black text-white">0</span>
                </button>

                <button onclick="resetTasbih()" class="text-slate-500 text-[10px] font-bold uppercase tracking-widest border-b border-slate-800 pb-1">Reset Count</button>
            </div>
        </div>

        <!-- Chat Input Bar (Only visible when chat tab is active) -->
        <div id="chat-input-container" class="hidden absolute bottom-24 left-4 right-4 z-30">
            <div class="glass rounded-full flex items-center p-1 shadow-2xl border-emerald-500/40">
                <input id="chat-input" type="text" placeholder="Ask Noor..." class="flex-1 bg-transparent px-5 py-3 text-sm outline-none">
                <button onclick="sendMessage()" class="bg-emerald-500 text-slate-950 p-3 rounded-full active:scale-90 transition-all">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg>
                </button>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <nav class="shrink-0 h-20 glass border-t border-emerald-900/30 flex items-center justify-around z-40 px-6">
            <button onclick="switchTab('home')" class="nav-btn text-emerald-500 flex flex-col items-center" id="nav-home">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg>
            </button>
            <button onclick="switchTab('chat')" class="nav-btn text-slate-500 flex flex-col items-center" id="nav-chat">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7z"></path></svg>
            </button>
            <button onclick="switchTab('tasbih')" class="nav-btn text-slate-500 flex flex-col items-center" id="nav-tasbih">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd"></path></svg>
            </button>
        </nav>
    </div>

    <script>
        const apiKey = ""; // API Key
        let count = parseInt(localStorage.getItem('noor_tasbih_fix')) || 0;
        let phrases = ["SubhanAllah", "Alhamdulillah", "Allahu Akbar", "La ilaha illallah"];
        let phraseIndex = 0;

        document.getElementById('tasbih-display').innerText = count;

        function switchTab(tabId) {
            // Reset UI
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.replace('text-emerald-500', 'text-slate-500'));
            
            // Activate Tab
            document.getElementById(tabId).classList.add('active');
            document.getElementById('nav-' + tabId).classList.replace('text-slate-500', 'text-emerald-500');
            
            // Show/Hide Chat Input
            const chatInputContainer = document.getElementById('chat-input-container');
            if (tabId === 'chat') {
                chatInputContainer.classList.remove('hidden');
            } else {
                chatInputContainer.classList.add('hidden');
            }

            // Scroll to top of tab
            document.getElementById('scroll-container').scrollTop = 0;
        }

        function countTasbih() {
            count++;
            if (count % 33 === 0) {
                phraseIndex = (phraseIndex + 1) % phrases.length;
                document.getElementById('tasbih-phrase').innerText = phrases[phraseIndex];
                if (navigator.vibrate) navigator.vibrate(40);
            }
            document.getElementById('tasbih-display').innerText = count;
            localStorage.setItem('noor_tasbih_fix', count);
        }

        function resetTasbih() {
            count = 0;
            document.getElementById('tasbih-display').innerText = 0;
            localStorage.setItem('noor_tasbih_fix', 0);
        }

        function addMessage(role, text) {
            const container = document.getElementById('chat-messages');
            const div = document.createElement('div');
            div.className = `flex ${role === 'user' ? 'justify-end' : 'justify-start'} mb-4`;
            
            const inner = document.createElement('div');
            inner.className = `p-4 rounded-2xl max-w-[85%] text-sm leading-relaxed shadow-lg ${
                role === 'user' 
                ? 'bg-emerald-600 text-white rounded-br-none' 
                : 'glass text-slate-200 rounded-bl-none border-emerald-900/50'
            }`;
            inner.innerText = text;
            
            div.appendChild(inner);
            container.appendChild(div);
            
            // Scroll container to bottom
            const scrollArea = document.getElementById('scroll-container');
            scrollArea.scrollTop = scrollArea.scrollHeight;
        }

        function askAI(query) {
            switchTab('chat');
            document.getElementById('chat-input').value = query;
            sendMessage();
        }

        async function sendMessage() {
            const input = document.getElementById('chat-input');
            const text = input.value.trim();
            if (!text) return;

            addMessage('user', text);
            input.value = '';

            const loaderId = 'loader-' + Date.now();
            const loaderDiv = document.createElement('div');
            loaderDiv.id = loaderId;
            loaderDiv.className = 'flex justify-start mb-4';
            loaderDiv.innerHTML = `<div class="glass p-4 rounded-2xl rounded-bl-none flex space-x-1">
                <div class="w-1 h-1 bg-emerald-500 rounded-full loading-dot"></div>
                <div class="w-1 h-1 bg-emerald-500 rounded-full loading-dot" style="animation-delay: 0.2s"></div>
                <div class="w-1 h-1 bg-emerald-500 rounded-full loading-dot" style="animation-delay: 0.4s"></div>
            </div>`;
            document.getElementById('chat-messages').appendChild(loaderDiv);
            document.getElementById('scroll-container').scrollTop = document.getElementById('scroll-container').scrollHeight;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: text }] }],
                        systemInstruction: { parts: [{ text: "You are Noor, a helpful Islamic AI. Keep answers clear, short, and respectful." }] }
                    })
                });

                const data = await response.json();
                const aiText = data.candidates[0].content.parts[0].text;
                
                document.getElementById(loaderId).remove();
                addMessage('assistant', aiText);
            } catch (error) {
                document.getElementById(loaderId).remove();
                addMessage('assistant', "I'm having a connection issue. Please check your internet.");
            }
        }

        // Enter key to send
        document.getElementById('chat-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });
    </script>
</body>
</html>

